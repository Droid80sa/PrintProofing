{% extends "base.html" %}
{% import 'components/ui_macros.html' as ui %}
{% block title %}Edit Customer â€“ {{ branding.company_name }}{% endblock %}
{% block content %}
  <section class="mx-auto max-w-4xl space-y-6">
    <header>
      <h1 class="text-3xl font-black text-slate-900">Edit customer</h1>
    </header>

    <div class="card space-y-4">
      <div class="flex items-center justify-between">
        <div>
          <h2 class="text-lg font-semibold text-slate-900">Customer portal access</h2>
          <p class="text-sm text-slate-500">{{ invite_status.label }}</p>
          {% if invite_status.detail %}
            <p class="text-xs text-slate-400">{{ invite_status.detail }}</p>
          {% endif %}
        </div>
        {% if portal_enabled %}
          <form method="post" action="{{ url_for('admin.admin_customer_invite', customer_id=customer.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
            <input type="hidden" name="redirect" value="{{ request.full_path }}">
            <button type="submit" class="btn-primary {% if invite_status.state == 'pending' %}opacity-60 cursor-not-allowed{% endif %}" {% if invite_status.state == 'pending' %}disabled{% endif %}>Send invite</button>
          </form>
        {% else %}
          <span class="text-sm font-medium text-amber-600">Enable the login portal to send invites.</span>
        {% endif %}
      </div>
    </div>

    <div class="card">
      <form method="post" action="{{ url_for('admin.admin_customer_edit', customer_id=customer.id) }}" class="space-y-4">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        <div class="space-y-1">
          <label for="name" class="text-sm font-medium text-slate-700">Customer name</label>
          <input type="text" id="name" name="name" value="{{ customer.name }}" required class="form-input block w-full rounded-lg border-slate-300 focus:border-brand-primary focus:ring-brand-primary">
        </div>
        <div class="space-y-1">
          <label for="company_name" class="text-sm font-medium text-slate-700">Company</label>
          <input type="text" id="company_name" name="company_name" value="{{ customer.company_name }}" class="form-input block w-full rounded-lg border-slate-300 focus:border-brand-primary focus:ring-brand-primary">
        </div>
        <div class="space-y-1">
          <label for="email" class="text-sm font-medium text-slate-700">Email</label>
          <input type="email" id="email" name="email" value="{{ customer.email }}" required class="form-input block w-full rounded-lg border-slate-300 focus:border-brand-primary focus:ring-brand-primary">
        </div>
        <div class="flex flex-wrap gap-3">
          {{ ui.button("Save changes", type="submit", extra_classes="justify-center") }}
          {{ ui.button("Cancel", variant="secondary", href=url_for('admin.admin_customers'), extra_classes="justify-center") }}
        </div>
      </form>
    </div>
  </section>
{% endblock %}
